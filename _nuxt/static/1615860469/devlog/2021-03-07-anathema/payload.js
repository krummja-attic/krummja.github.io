__NUXT_JSONP__("/devlog/2021-03-07-anathema", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,$,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE,aF,aG,aH,aI,aJ,aK,aL,aM,aN,aO,aP,aQ,aR,aS,aT,aU,aV,aW,aX,aY,aZ,a_,a$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR){return {data:[{log:{slug:"2021-03-07-anathema",description:"Reworking some of the component logic and entity event processing.",title:"refactor\u002Fcomponents",project:"Anathema",repo:"https:\u002F\u002Fgithub.com\u002Fkrummja\u002FAnathema",toc:[{id:aO,depth:ap,text:aP},{id:aQ,depth:ap,text:aR},{id:aS,depth:af,text:ag},{id:aT,depth:af,text:ah},{id:aU,depth:af,text:R},{id:aV,depth:af,text:aW},{id:aX,depth:ap,text:aY}],body:{type:"root",children:[{type:b,tag:aq,props:{id:aO},children:[{type:b,tag:x,props:{href:"#problem",ariaHidden:S,tabIndex:T},children:[{type:b,tag:c,props:{className:[U,V]},children:[]}]},{type:a,value:aP}]},{type:a,value:f},{type:b,tag:r,props:{},children:[{type:a,value:"Anathema's interaction system makes heavy use of the "},{type:b,tag:h,props:{},children:[{type:a,value:aZ}]},{type:a,value:" class provided by "},{type:b,tag:x,props:{href:a_,rel:[ar,as,at],target:au},children:[{type:a,value:a$}]},{type:a,value:". This works very well, but I have to do a couple of \"hacky\" things to route data from the player's "},{type:b,tag:h,props:{},children:[{type:a,value:av}]},{type:a,value:" component to the target interactable entity to the interface and systems logic."}]},{type:a,value:f},{type:b,tag:r,props:{},children:[{type:a,value:"Currently I pass a "},{type:b,tag:h,props:{},children:[{type:a,value:"dict"}]},{type:a,value:" along as event data, usually with some field that contains an iterable I can collect usable information in. This can be a bit messy, especially when it comes to getting information to the UI, so I want to address that if I can."}]},{type:a,value:f},{type:b,tag:r,props:{},children:[{type:a,value:"In this devlog, I want to write out some notes outlining how this works, ultimately aiming to tighten up the process to make it more reliable and easier to use."}]},{type:a,value:f},{type:b,tag:aq,props:{id:aQ},children:[{type:b,tag:x,props:{href:"#base-case",ariaHidden:S,tabIndex:T},children:[{type:b,tag:c,props:{className:[U,V]},children:[]}]},{type:a,value:aR}]},{type:a,value:f},{type:b,tag:r,props:{},children:[{type:a,value:"Let's take a look at an example of a basic interaction, say a player movement that touches some entity in the world that, on touch, triggers a state change in the entity. A prime example is a chest or other container, which we expect to (a) change visual state, and (b) raise a modal in the UI with options to select from. On selection of an option, some method on the entity's components should be fired, resulting in a change to the game state."}]},{type:a,value:f},{type:b,tag:ai,props:{id:aS},children:[{type:b,tag:x,props:{href:"#inputcontroller",ariaHidden:S,tabIndex:T},children:[{type:b,tag:c,props:{className:[U,V]},children:[]}]},{type:a,value:ag}]},{type:a,value:f},{type:b,tag:r,props:{},children:[{type:a,value:"Inputs are handled by a manager class, "},{type:b,tag:h,props:{},children:[{type:a,value:"Anathema.core.input.InputController"}]},{type:a,value:", which essentially wraps "},{type:b,tag:h,props:{},children:[{type:a,value:"bearlibterminal"}]},{type:a,value:"'s "},{type:b,tag:h,props:{},children:[{type:a,value:"terminal.read"}]},{type:a,value:" to get key events."}]},{type:a,value:f},{type:b,tag:B,props:{className:[C]},children:[{type:b,tag:D,props:{className:[E,F]},children:[{type:b,tag:h,props:{},children:[{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,M]},children:[{type:a,value:"handle_input"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:N}]},{type:a,value:ba},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:bb},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,y]},children:[{type:a,value:H}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:"\n    terminal"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:" NiceTerminal "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:u}]},{type:a,value:I},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:aw},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"renderer"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"terminal\n    key"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:z}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:u}]},{type:a,value:" terminal"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"read"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:bc},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bd}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:"\n        command"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:" Callable"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,y]},children:[{type:a,value:H}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:u}]},{type:a,value:I},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:ax},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:X},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:be}]},{type:a,value:" StateBreak"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:J},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:K}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,y]},children:[{type:a,value:H}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:Y}]},{type:a,value:" command "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:"is"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:"not"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,y]},children:[{type:a,value:H}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:J},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:K}]},{type:a,value:" command\n"}]}]}]},{type:a,value:f},{type:b,tag:r,props:{},children:[{type:a,value:"On each input event, the "},{type:b,tag:h,props:{},children:[{type:a,value:X}]},{type:a,value:" is passed to a method "},{type:b,tag:h,props:{},children:[{type:a,value:ax}]},{type:a,value:" on the "},{type:b,tag:h,props:{},children:[{type:a,value:ag}]},{type:a,value:" and ultimately to a separate "},{type:b,tag:h,props:{},children:[{type:a,value:aj}]},{type:a,value:i}]},{type:a,value:f},{type:b,tag:B,props:{className:[C]},children:[{type:b,tag:D,props:{className:[E,F]},children:[{type:b,tag:h,props:{},children:[{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,M]},children:[{type:a,value:ax}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:bf},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:N}]},{type:a,value:ba},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:bb},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,y]},children:[{type:a,value:H}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:Y}]},{type:a,value:ay},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:az}]},{type:a,value:Z},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:J},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:K}]},{type:a,value:I},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:_},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:aB},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bg}]},{type:a,value:aj},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:X},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:Y}]},{type:a,value:ay},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:az}]},{type:a,value:Z},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:_},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:bh},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:bi},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:u}]},{type:a,value:Z},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:_},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:bh},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:J},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:K}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:bj}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:_},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,bk]},children:[{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bl}]},{type:b,tag:c,props:{className:[d,bm]},children:[{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:$}]},{type:a,value:bn},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:X},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:aa}]}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bo}]}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:"elif"}]},{type:a,value:ay},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:az}]},{type:a,value:Z},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:"'DEFAULT'"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:bi},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:u}]},{type:a,value:Z},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:"'DEFAULT"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:J},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:K}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:bj}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:_},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,bk]},children:[{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bl}]},{type:b,tag:c,props:{className:[d,bm]},children:[{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:$}]},{type:a,value:bn},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:a,value:X},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:aa}]}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bo}]}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:"else"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:J},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:K}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,y]},children:[{type:a,value:H}]},{type:a,value:f}]}]}]},{type:a,value:f},{type:b,tag:"sticky",props:{style:"font-size: 14pt;"},children:[{type:a,value:"\nOne minor annoyance I should look into fixing is that I have to override the cmd_* methods in any Screen subclasses I don't want that behavior to be present in...\n"}]},{type:a,value:f},{type:b,tag:r,props:{},children:[{type:a,value:"In short, a keyboard input is an "},{type:b,tag:h,props:{},children:[{type:a,value:z}]},{type:a,value:" that is checked against a dictionary of pre-defined methods on "},{type:b,tag:h,props:{},children:[{type:a,value:bp}]},{type:a,value:" objects. These methods are all prefixed "},{type:b,tag:h,props:{},children:[{type:a,value:"cmd_*"}]},{type:a,value:", making lookup and, ultimately, calling of the relevant methods fairly straightforward."},{type:b,tag:bq,props:{id:"fnref-1"},children:[{type:b,tag:x,props:{href:"#fn-1",className:[br]},children:[{type:a,value:ab}]}]}]},{type:a,value:f},{type:b,tag:r,props:{},children:[{type:a,value:"Of interest to the current use case is moving the player. So, we press an arrow key (or numpad key) on the keyboard, which returns something we can check against our "},{type:b,tag:h,props:{},children:[{type:a,value:aj}]},{type:a,value:i}]},{type:a,value:f},{type:b,tag:B,props:{className:[C]},children:[{type:b,tag:D,props:{className:[E,F]},children:[{type:b,tag:h,props:{},children:[{type:a,value:aA},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:bs},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:aC},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:u}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:$}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:O}]},{type:a,value:bt},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"TK_UP"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:al}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:ab}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:O}]},{type:a,value:bt},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"TK_KP_8"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:al}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:ab}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:O}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:aa}]},{type:a,value:f}]}]}]},{type:a,value:f},{type:b,tag:r,props:{},children:[{type:a,value:"In our "},{type:b,tag:h,props:{},children:[{type:a,value:ag}]},{type:a,value:", we're passing the dictionary value to "},{type:b,tag:h,props:{},children:[{type:a,value:aB}]},{type:a,value:" on the currently active "},{type:b,tag:h,props:{},children:[{type:a,value:bp}]},{type:a,value:". During gameplay, this is our "},{type:b,tag:h,props:{},children:[{type:a,value:ah}]},{type:a,value:" screen, so let's see what happens there."}]},{type:a,value:f},{type:b,tag:ai,props:{id:aT},children:[{type:b,tag:x,props:{href:"#playerready",ariaHidden:S,tabIndex:T},children:[{type:b,tag:c,props:{className:[U,V]},children:[]}]},{type:a,value:ah}]},{type:a,value:f},{type:b,tag:r,props:{},children:[{type:a,value:"It turns out not to be too interesting."}]},{type:a,value:f},{type:b,tag:B,props:{className:[C]},children:[{type:b,tag:D,props:{className:[E,F]},children:[{type:b,tag:h,props:{},children:[{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ac}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,ad]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:"AbstractScreen"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:O}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,M]},children:[{type:a,value:aB}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:bu},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:aD},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:N}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,y]},children:[{type:a,value:H}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:aE},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:aw},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:bv},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:ae},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:"x"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:aD},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:f}]}]}]},{type:a,value:f},{type:b,tag:r,props:{},children:[{type:a,value:"Our method simply routes the tuple we got from our "},{type:b,tag:h,props:{},children:[{type:a,value:aj}]},{type:a,value:" to the "},{type:b,tag:h,props:{},children:[{type:a,value:ae}]},{type:a,value:" method on the game's "},{type:b,tag:h,props:{},children:[{type:a,value:R}]},{type:a,value:", so heading there..."}]},{type:a,value:f},{type:b,tag:ai,props:{id:aU},children:[{type:b,tag:x,props:{href:"#playermanager",ariaHidden:S,tabIndex:T},children:[{type:b,tag:c,props:{className:[U,V]},children:[]}]},{type:a,value:R}]},{type:a,value:f},{type:b,tag:r,props:{},children:[{type:a,value:"Aha, now we're talking! Now we have to handle some concrete logic. Note firstly that we store the player's position as a property, which is just for convenience."}]},{type:a,value:f},{type:b,tag:B,props:{className:[C]},children:[{type:b,tag:D,props:{className:[E,F]},children:[{type:b,tag:h,props:{},children:[{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ac}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,ad]},children:[{type:a,value:R}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:"AbstractManager"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:O}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,bw,bx,e]},children:[{type:a,value:"@property"}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,M]},children:[{type:a,value:aF}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:N}]},{type:a,value:aC},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:J},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:K}]},{type:a,value:I},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:W},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:aG}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"xy\n    "},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:O}]},{type:a,value:f}]}]}]},{type:a,value:f},{type:b,tag:r,props:{},children:[{type:a,value:"We use this property in our "},{type:b,tag:h,props:{},children:[{type:a,value:ae}]},{type:a,value:" method:"}]},{type:a,value:f},{type:b,tag:B,props:{className:[C]},children:[{type:b,tag:D,props:{className:[E,F]},children:[{type:b,tag:h,props:{},children:[{type:a,value:am},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:O}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,M]},children:[{type:a,value:ae}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:aH},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:aC},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:N}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,y]},children:[{type:a,value:H}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:"\n        target_x "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:u}]},{type:a,value:I},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:aF},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:al}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:by}]},{type:a,value:aH},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:al}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:"\n        target_y "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:u}]},{type:a,value:I},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:aF},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:ab}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:by}]},{type:a,value:aH},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:ab}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:O}]},{type:a,value:f}]}]}]},{type:a,value:f},{type:b,tag:r,props:{},children:[{type:a,value:"We compute a target position by adding our input offset to our current position. If position is "},{type:b,tag:h,props:{},children:[{type:a,value:"(10, 12)"}]},{type:a,value:" and we returned the value of "},{type:b,tag:h,props:{},children:[{type:a,value:"blt.TK_UP"}]},{type:a,value:", then we'll get an updated position "},{type:b,tag:h,props:{},children:[{type:a,value:"(10, 11)"}]},{type:a,value:". Simple!"}]},{type:a,value:f},{type:b,tag:r,props:{},children:[{type:a,value:"Now, in a completely featureless environment where we don't care about collisions or other entities, we simply pass this new position to an "},{type:b,tag:h,props:{},children:[{type:a,value:an}]},{type:a,value:" which we enqueue to be executed on the next turn."}]},{type:a,value:f},{type:b,tag:B,props:{className:[C]},children:[{type:b,tag:D,props:{className:[E,F]},children:[{type:b,tag:h,props:{},children:[{type:a,value:am},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:O}]},{type:a,value:"\n    self"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:bz},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"append"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:"\n        Action"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:bA},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:u}]},{type:a,value:I},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:W},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:"\n                event  "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:u}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bB}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:"\n                data   "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:u}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:$}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:aI}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:bC},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:bD},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:aa}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:f}]}]}]},{type:a,value:f},{type:b,tag:r,props:{},children:[{type:a,value:aJ},{type:b,tag:h,props:{},children:[{type:a,value:R}]},{type:a,value:" has an "},{type:b,tag:h,props:{},children:[{type:a,value:bz}]},{type:a,value:" attribute which is a "},{type:b,tag:h,props:{},children:[{type:a,value:"collections.deque"}]},{type:a,value:" instance. Each cycle of the game engine, if this queue has anything in it, we call a method "},{type:b,tag:h,props:{},children:[{type:a,value:bE}]},{type:a,value:" which in turn calls "},{type:b,tag:h,props:{},children:[{type:a,value:"self.action_queue.popleft()"}]},{type:a,value:". We return this to the "},{type:b,tag:h,props:{},children:[{type:a,value:aK}]},{type:a,value:" which calls "},{type:b,tag:h,props:{},children:[{type:a,value:bF}]},{type:a,value:". So let's see how that works before proceeding with the remaining logic here in our "},{type:b,tag:h,props:{},children:[{type:a,value:ae}]},{type:a,value:" method."}]},{type:a,value:f},{type:b,tag:ai,props:{id:aV},children:[{type:b,tag:x,props:{href:"#action-and-actionsystem",ariaHidden:S,tabIndex:T},children:[{type:b,tag:c,props:{className:[U,V]},children:[]}]},{type:a,value:aW}]},{type:a,value:f},{type:b,tag:r,props:{},children:[{type:a,value:"When we enqueued our "},{type:b,tag:h,props:{},children:[{type:a,value:an}]},{type:a,value:", we passed in a bunch of information that we'll need for resolving the actual action logic."}]},{type:a,value:f},{type:b,tag:B,props:{className:[C]},children:[{type:b,tag:D,props:{className:[E,F]},children:[{type:b,tag:h,props:{},children:[{type:b,tag:c,props:{className:[d,bw,bx,e]},children:[{type:a,value:"@dataclass"}]},{type:a,value:f},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ac}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,ad]},children:[{type:a,value:an}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:"\n    entity"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:" Entity\n    event"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:bG}]},{type:a,value:"\n    data"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:bs},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:bG}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:" Any"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:a,value:f}]}]}]},{type:a,value:f},{type:b,tag:r,props:{},children:[{type:a,value:"In the "},{type:b,tag:h,props:{},children:[{type:a,value:aK}]},{type:a,value:", we call the "},{type:b,tag:h,props:{},children:[{type:a,value:bF}]},{type:a,value:" method to execute the actual logic of the action."}]},{type:a,value:f},{type:b,tag:B,props:{className:[C]},children:[{type:b,tag:D,props:{className:[E,F]},children:[{type:b,tag:h,props:{},children:[{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ac}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,ad]},children:[{type:a,value:aK}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:"AbstractSystem"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:aL}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,M]},children:[{type:a,value:"update"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:N}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:"bool"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:"\n        entities "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:u}]},{type:a,value:I},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:bH},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"result\n        entities "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:u}]},{type:a,value:" deque"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:"sorted"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:"entities"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:bf},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:"lambda"}]},{type:a,value:bI},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:bI},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bJ}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:"\n        entity "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:u}]},{type:a,value:" entities"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"popleft"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:J},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:O}]},{type:a,value:J},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:"while"}]},{type:a,value:bA},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:"and"}]},{type:a,value:bK},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bJ}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"has_energy"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:"\n            "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:Y}]},{type:a,value:bK},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"has"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:"'IsPlayer'"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:bL},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bd}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:"\n                    action "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:u}]},{type:a,value:I},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:aw},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:bv},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:bE},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:aM},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:Y}]},{type:a,value:" action"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:"\n                        action"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:ao},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:"\n                        "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:K}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,y]},children:[{type:a,value:"True"}]},{type:a,value:aM},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:"continue"}]},{type:a,value:bL},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:be}]},{type:a,value:" IndexError"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:aM},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:K}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,y]},children:[{type:a,value:"False"}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:aL}]},{type:a,value:f}]}]}]},{type:a,value:f},{type:b,tag:r,props:{},children:[{type:a,value:aJ},{type:b,tag:h,props:{},children:[{type:a,value:bH}]},{type:a,value:" attribute holds references to all of the entities in the game that have an "},{type:b,tag:h,props:{},children:[{type:a,value:av}]},{type:a,value:" component."},{type:b,tag:bq,props:{id:"fnref-2"},children:[{type:b,tag:x,props:{href:"#fn-2",className:[br]},children:[{type:a,value:"2"}]}]},{type:a,value:" We sort our entities by their "},{type:b,tag:h,props:{},children:[{type:a,value:av}]},{type:a,value:" component (which sorts them by energy - more on that later). If the current entity is the player, get the next player action and run its "},{type:b,tag:h,props:{},children:[{type:a,value:ao}]},{type:a,value:" method - so let's look at what that entails."}]},{type:a,value:f},{type:b,tag:B,props:{className:[C]},children:[{type:b,tag:D,props:{className:[E,F]},children:[{type:b,tag:h,props:{},children:[{type:a,value:am},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:"# in Action"}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,M]},children:[{type:a,value:ao}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:N}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,y]},children:[{type:a,value:H}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:J},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:K}]},{type:a,value:I},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:W},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:aN},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"event"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:I},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:bM},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:f}]}]}]},{type:a,value:f},{type:b,tag:r,props:{},children:[{type:a,value:"Alright, so that's straightforward. We're using the ECS to make an "},{type:b,tag:h,props:{},children:[{type:a,value:aZ}]},{type:a,value:", passing in our event data that we set up in the "},{type:b,tag:h,props:{},children:[{type:a,value:R}]},{type:a,value:j}]},{type:a,value:f},{type:b,tag:B,props:{className:[C]},children:[{type:b,tag:D,props:{className:[E,F]},children:[{type:b,tag:h,props:{},children:[{type:a,value:am},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,M]},children:[{type:a,value:ao}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:N}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,y]},children:[{type:a,value:H}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:J},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:K}]},{type:a,value:I},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:W},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:aN},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bB}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:"\n                                      "},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:$}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:aI}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:bC},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:bD},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:aa}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:f}]}]}]},{type:a,value:f},{type:b,tag:r,props:{},children:[{type:a,value:aJ},{type:b,tag:h,props:{},children:[{type:a,value:aN}]},{type:a,value:" method broadcasts the event "},{type:b,tag:h,props:{},children:[{type:a,value:"try_move"}]},{type:a,value:" with data "},{type:b,tag:h,props:{},children:[{type:a,value:"{'target': (..., ...)}"}]},{type:a,value:" to every component attached to the player entity. To be usable, at least one component better implement a method "},{type:b,tag:h,props:{},children:[{type:a,value:bN}]},{type:a,value:" for the ECS to do something with. Well, it so happens that our player does have such a component:"}]},{type:a,value:f},{type:b,tag:B,props:{className:[C]},children:[{type:b,tag:D,props:{className:[E,F]},children:[{type:b,tag:h,props:{},children:[{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ac}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,ad]},children:[{type:a,value:"Legs"}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:"BodyPart"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,A]},children:[{type:a,value:aL}]},{type:a,value:s},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,M]},children:[{type:a,value:bN}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:" evt"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:" EntityEvent"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:N}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,y]},children:[{type:a,value:H}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:aE},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:bO},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bg}]},{type:a,value:"evt"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:bM},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:aI}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:"\n        evt"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"handle"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:bc},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,M]},children:[{type:a,value:bO}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:m}]},{type:a,value:w},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:bu},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:q}]},{type:a,value:aD},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,t]},children:[{type:a,value:z}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:n}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:G}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:N}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,y]},children:[{type:a,value:H}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:j}]},{type:a,value:aE},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:W},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:aG}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"x "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:u}]},{type:a,value:" x\n        self"},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:W},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:o}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:aG}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,e]},children:[{type:a,value:i}]},{type:a,value:"y "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:u}]},{type:a,value:" y\n"}]}]}]},{type:a,value:f},{type:b,tag:r,props:{},children:[{type:a,value:"The end result is that the actual position of the entity changes on the next cycle of the "},{type:b,tag:h,props:{},children:[{type:a,value:"PhysicsSystem"}]},{type:a,value:", which queries for entities with "},{type:b,tag:h,props:{},children:[{type:a,value:"Position"}]},{type:a,value:" and updates them accordingly."}]},{type:a,value:f},{type:b,tag:aq,props:{id:aX},children:[{type:b,tag:x,props:{href:"#interim-comments",ariaHidden:S,tabIndex:T},children:[{type:b,tag:c,props:{className:[U,V]},children:[]}]},{type:a,value:aY}]},{type:a,value:f},{type:b,tag:r,props:{},children:[{type:a,value:"Alright, so that was a lot to unpack. The basic workflow, however, is fairly straightforward."}]},{type:a,value:f},{type:b,tag:bP,props:{},children:[{type:a,value:f},{type:b,tag:P,props:{},children:[{type:a,value:"Get input from the keyboard."}]},{type:a,value:f},{type:b,tag:P,props:{},children:[{type:a,value:"Look up an appropriate method or tuple."}]},{type:a,value:f},{type:b,tag:P,props:{},children:[{type:a,value:"Fire the method on the current Screen or pass a tuple to a method."}]},{type:a,value:f},{type:b,tag:P,props:{},children:[{type:a,value:"Create an "},{type:b,tag:h,props:{},children:[{type:a,value:an}]},{type:a,value:" with, at minimum, an event name (a string) and some concrete data (a dict)."}]},{type:a,value:f},{type:b,tag:P,props:{},children:[{type:a,value:"Enqueue the action."}]},{type:a,value:f},{type:b,tag:P,props:{},children:[{type:a,value:"Fire the action's event, broadcasting it to the entity's component set."}]},{type:a,value:f},{type:b,tag:P,props:{},children:[{type:a,value:"On detecting an event, grab the event data and do some work with it."}]},{type:a,value:f}]},{type:a,value:f},{type:b,tag:r,props:{},children:[{type:a,value:"Now, this is the simplest case. However, there is more that happens in the "},{type:b,tag:h,props:{},children:[{type:a,value:R}]},{type:a,value:". Recall that we just created an action without regard for other world entities. What if we want to check for obstacles, or do something like see if we're running into an interactable? Well... then things get just a tad more complex."}]},{type:a,value:f},{type:b,tag:r,props:{},children:[{type:a,value:"This is getting to be a bit long, so I think I'll call this good here and take it as an overview of the base case. In the second part, I'll break down the more advanced case of trying to check for interactables."}]},{type:a,value:f},{type:b,tag:B,props:{className:["footnotes"]},children:[{type:a,value:f},{type:b,tag:"hr",props:{},children:[]},{type:a,value:f},{type:b,tag:bP,props:{},children:[{type:a,value:f},{type:b,tag:P,props:{id:"fn-1"},children:[{type:a,value:"This is a pattern that I first came across while studying "},{type:b,tag:x,props:{href:"https:\u002F\u002Fgithub.com\u002FHexDecimal\u002Froguelike-tutorial",rel:[ar,as,at],target:au},children:[{type:a,value:"HexDecimal's tcod-based tutorial project"}]},{type:a,value:". I've since implemented it in most of my projects, as it's so intuitive."},{type:b,tag:x,props:{href:"#fnref-1",className:[bQ]},children:[{type:a,value:bR}]}]},{type:a,value:f},{type:b,tag:P,props:{id:"fn-2"},children:[{type:a,value:"See the documentation for "},{type:b,tag:x,props:{href:a_,rel:[ar,as,at],target:au},children:[{type:a,value:a$}]},{type:a,value:" to see how this works in more detail."},{type:b,tag:x,props:{href:"#fnref-2",className:[bQ]},children:[{type:a,value:bR}]}]},{type:a,value:f}]},{type:a,value:f}]}]},dir:"\u002Flogs",path:"\u002Flogs\u002F2021-03-07-anathema",extension:".md",createdAt:"2021-03-07T18:23:18.965Z",updatedAt:"2021-03-10T02:50:25.052Z"}}],fetch:{},mutations:void 0}}("text","element","span","token","punctuation","\n"," ","code",".",":","keyword","operator","(",")","[","]",",","p","\n    ","builtin","=","string","self","a","boolean","int","comment","div","nuxt-content-highlight","pre","language-python","line-numbers","-","None"," self","\n        ","return","def","function","\u003E","# ...","li","number","PlayerManager","true",-1,"icon","icon-link","entity","key","if"," CommandLibrary","_current_screen","{","}","1","class","class-name","move",3,"InputController","PlayerReady","h3","CommandLibrary","COMMAND_KEYS","0","    ","Action","act",2,"h2","nofollow","noopener","noreferrer","_blank","Actor","game","command_lookup"," key ","in","MOVE_KEYS","cmd_move"," Tuple"," y","\n        self","position","'Position'"," direction","'target'","The ","ActionSystem","#...","\n                    ","fire_event","problem","Problem","base-case","Base Case","inputcontroller","playerready","playermanager","action-and-actionsystem","Action and ActionSystem","interim-comments","Interim Comments","EntityEvent","https:\u002F\u002Fgithub.com\u002Fkrummja\u002FECStremity","ECStremity"," Optional","Callable","\n\n    ","try","except"," key","*","name","\n        commands ","getattr","string-interpolation","f\"cmd_","interpolation","commands","\"","Screen","sup","footnote-ref"," Dict","\n    blt"," x","player","decorator","annotation","+","action_queue"," entity ","'try_move'","target_x"," target_y","get_next_action","Action.act","str","_query"," e","'Actor'"," entity","\n                ","data","on_try_move","update_position","ol","footnote-backref","↩")));